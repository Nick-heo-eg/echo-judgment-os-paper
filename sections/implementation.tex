\section{Implementation}\label{sec:implementation}
\subsection{Runtime Environment}
Echo Scheduler orchestrates loops; EchoGraph models state transitions; envelope adapters constrain prompts; the Proof Engine writes canonical artifacts. Implementations reside under \texttt{core/}, \texttt{runtime/}, and \texttt{capsules/} within the Echo codebase.

\subsection{Judgement Pipeline Listing}
Algorithm~\ref{alg:judgement} presents the Python implementation (also shipped in \texttt{code/judgement\_engine.py}). The LLM node is mocked for reproducibility; replacing the stub does not affect OS behaviour.
\begin{algorithm}[t]
\caption{Echo Judgement Engine}\label{alg:judgement}
\begin{lstlisting}[language=Python,basicstyle=\ttfamily\footnotesize]
def echo_judgement(request):
    semantics = semantic_parser(request.text, request.context)
    frame_key = existential_frame_map(semantics, identity_manifest())
    srl_state = srl_core.load_state()
    resonance = srl_state.align(frame_key, semantics.resonance_features)
    srl_state.commit(resonance)
    decision_entry = judgement_lookup_table.fetch(frame_key, resonance)
    if decision_entry is None:
        decision_entry = judgement_lookup_table.fallback(frame_key)
    envelope = build_envelope(decision_entry.prompt_template,
                              request.user_text,
                              decision_entry.capsules)
    llm_response = llm_adapter.invoke(envelope)
    validated = validator.verify(llm_response,
                                 decision_entry.policy,
                                 resonance)
    if not validated.accepted:
        validated = validator.override(decision_entry.override_action)
    final_output = formatter.compose(validated.text,
                                     decision_entry.metadata)
    trace = trace_signature.generate(
        mode="ECHO_JUDGEMENT",
        resonance=resonance.vector,
        permanence=True,
        deterministic_hash=decision_entry.hash
    )
    proof_engine.record(request,
                        decision_entry,
                        llm_response,
                        resonance,
                        trace)
    return final_output + "\n\n---\nTrace Signature\n" + trace
\end{lstlisting}
\end{algorithm}

\subsection{Trace and Proof Modules}
Trace Signatures follow the grammar in Appendix~\ref{app:appendix}; Proof Capsules pack context, judgement metadata, SRL vectors, and validation logs for each decision.
